<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhytoOracle - çŸ¥è¯†ç®¡ç†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .header {
            background: #fff;
            border-bottom: 1px solid #e8e8e8;
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .header h1 {
            font-size: 20px;
            font-weight: 500;
            color: #1890ff;
        }

        .btn {
            padding: 8px 16px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            background: #fff;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn:hover {
            color: #1890ff;
            border-color: #1890ff;
        }

        .btn-primary {
            background: #1890ff;
            color: #fff;
            border-color: #1890ff;
        }

        .btn-primary:hover {
            background: #40a9ff;
        }

        .btn-success {
            background: #52c41a;
            color: #fff;
            border-color: #52c41a;
        }

        .btn-success:hover {
            background: #73d13d;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            height: calc(100vh - 65px);
            max-width: 1400px;
            margin: 0 auto;
        }

        .sidebar {
            background: #fff;
            border-right: 1px solid #e8e8e8;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #e8e8e8;
            font-weight: 500;
            color: #333;
        }

        .tree-view {
            padding: 12px 0;
        }

        .tree-node {
            list-style: none;
        }

        .tree-item {
            padding: 8px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .tree-item:hover {
            background: #f5f5f5;
        }

        .tree-item.active {
            background: #e6f7ff;
            color: #1890ff;
            border-left: 3px solid #1890ff;
        }

        .tree-icon {
            font-size: 14px;
            transition: transform 0.3s;
        }

        .tree-icon.expanded {
            transform: rotate(90deg);
        }

        .tree-children {
            padding-left: 24px;
            display: none;
        }

        .tree-children.visible {
            display: block;
        }

        .tree-section-title {
            padding: 16px 20px 8px 20px;
            font-size: 12px;
            color: #8c8c8c;
            font-weight: 500;
            text-transform: uppercase;
        }

        .content-area {
            background: #f5f5f5;
            overflow-y: auto;
        }

        .toolbar {
            background: #fff;
            padding: 16px 24px;
            border-bottom: 1px solid #e8e8e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .toolbar-left {
            display: flex;
            gap: 12px;
        }

        .toolbar-title {
            font-size: 18px;
            font-weight: 500;
            color: #333;
        }

        .content-body {
            padding: 24px;
        }

        .dimension-card {
            background: #fff;
            border-radius: 8px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .card-header {
            padding: 16px 20px;
            background: #fafafa;
            border-bottom: 1px solid #e8e8e8;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .card-header:hover {
            background: #f0f0f0;
        }

        .card-title {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ontology-badge {
            display: inline-block;
            background: #e6f7ff;
            color: #1890ff;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 400;
            border: 1px solid #91d5ff;
        }

        .card-meta {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .weight-badge {
            background: #e6f7ff;
            color: #1890ff;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
        }

        .collapse-icon {
            transition: transform 0.3s;
            color: #999;
        }

        .dimension-card.collapsed .collapse-icon {
            transform: rotate(-90deg);
        }

        .card-body {
            padding: 20px;
            display: block;
        }

        .dimension-card.collapsed .card-body {
            display: none;
        }

        .field-group {
            margin-bottom: 20px;
        }

        .field-label {
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .field-value {
            padding: 10px 12px;
            background: #fafafa;
            border: 1px solid #e8e8e8;
            border-radius: 4px;
            font-size: 14px;
            color: #333;
            width: 100%;
            box-sizing: border-box;
            font-family: inherit;
        }

        .field-value:focus {
            outline: none;
            border-color: #1890ff;
            background: #fff;
        }

        .vlm-descriptions {
            margin-top: 20px;
            padding: 16px;
            background: #f9f9f9;
            border-radius: 4px;
            border-left: 3px solid #1890ff;
        }

        .vlm-title {
            font-weight: 500;
            color: #333;
            margin-bottom: 12px;
            font-size: 15px;
        }

        .vlm-section {
            margin-bottom: 16px;
        }

        .vlm-section:last-child {
            margin-bottom: 0;
        }

        .vlm-subtitle {
            font-size: 13px;
            color: #8c8c8c;
            margin-bottom: 6px;
        }

        .vlm-content {
            font-size: 14px;
            color: #333;
            line-height: 1.8;
            padding: 8px 0;
        }

        .vlm-textarea {
            width: 100%;
            min-height: 80px;
            padding: 10px 12px;
            border: 1px solid #e8e8e8;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
        }

        .vlm-textarea:focus {
            outline: none;
            border-color: #1890ff;
        }

        .treatment-section {
            background: #fff;
            border-radius: 8px;
            padding: 24px;
            margin-top: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            cursor: pointer;
        }

        .section-title {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .treatment-content {
            padding: 16px;
            background: #fafafa;
            border-radius: 4px;
        }

        .treatment-section.collapsed .treatment-content {
            display: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #fff;
            border-radius: 8px;
            padding: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 16px;
        }

        .modal-body {
            margin-bottom: 24px;
        }

        .modal-footer {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .version-list {
            list-style: none;
        }

        .version-item {
            padding: 12px;
            border: 1px solid #e8e8e8;
            border-radius: 4px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .version-item:hover {
            background: #f5f5f5;
            border-color: #1890ff;
        }

        .version-name {
            font-weight: 500;
            color: #333;
            margin-bottom: 4px;
        }

        .version-meta {
            font-size: 12px;
            color: #8c8c8c;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>PhytoOracle - çŸ¥è¯†ç®¡ç†</h1>
        <button class="btn" onclick="goBack()">è¿”å›é¦–é¡µ</button>
    </div>

    <div class="main-layout">
        <!-- å·¦ä¾§ç›®å½•æ ‘ -->
        <div class="sidebar">
            <div class="sidebar-header">çŸ¥è¯†åº“ç›®å½•</div>
            <ul class="tree-view">
                <li class="tree-node">
                    <div class="tree-item" onclick="toggleTreeNode(this)">
                        <span class="tree-icon expanded">â–¶</span>
                        <span>ğŸŒ¹ Rosa (è”·è–‡å±)</span>
                    </div>
                    <ul class="tree-children visible">
                        <li class="tree-item active" onclick="selectDisease('rose_black_spot')">ç«ç‘°é»‘æ–‘ç—…</li>
                        <li class="tree-item" onclick="selectDisease('rose_powdery_mildew')">ç«ç‘°ç™½ç²‰ç—…</li>
                        <li class="tree-item" onclick="selectDisease('rose_rust')">ç«ç‘°é”ˆç—…</li>
                    </ul>
                </li>

                <li class="tree-node">
                    <div class="tree-item" onclick="toggleTreeNode(this)">
                        <span class="tree-icon expanded">â–¶</span>
                        <span>ğŸŒ¸ Prunus (æå±)</span>
                    </div>
                    <ul class="tree-children visible">
                        <li class="tree-item" onclick="selectDisease('cherry_powdery_mildew')">æ¨±èŠ±ç™½ç²‰ç—…</li>
                        <li class="tree-item" onclick="selectDisease('cherry_leaf_spot')">æ¨±èŠ±å¶æ–‘ç—…</li>
                    </ul>
                </li>

                <li class="tree-node">
                    <div class="tree-item" onclick="toggleTreeNode(this)">
                        <span class="tree-icon">â–¶</span>
                        <span>ğŸŒ· Tulipa (éƒé‡‘é¦™å±)</span>
                    </div>
                    <ul class="tree-children">
                        <li class="tree-item" onclick="selectDisease('tulip_gray_mold')">éƒé‡‘é¦™ç°éœ‰ç—…</li>
                        <li class="tree-item" onclick="selectDisease('tulip_fire')">éƒé‡‘é¦™ç«ç–«ç—…</li>
                    </ul>
                </li>

                <li class="tree-section-title">â”â”â”â”â” å…¶ä»– â”â”â”â”â”</li>

                <li class="tree-node">
                    <div class="tree-item" onclick="alert('ç‰¹å¾æœ¬ä½“è¯·åœ¨ã€æœ¬ä½“ç»“æ„ç®¡ç†ã€‘ä¸­æŸ¥çœ‹')">
                        <span>ğŸ¯ ç‰¹å¾æœ¬ä½“</span>
                    </div>
                </li>

                <li class="tree-node">
                    <div class="tree-item" onclick="alert('å®¿ä¸»å…³è”è¯·åœ¨ã€æœ¬ä½“ç»“æ„ç®¡ç†ã€‘ä¸­æŸ¥çœ‹')">
                        <span>ğŸ”— å®¿ä¸»å…³è”</span>
                    </div>
                </li>
            </ul>
        </div>

        <!-- å³ä¾§å†…å®¹åŒº -->
        <div class="content-area">
            <div class="toolbar">
                <div class="toolbar-title" id="diseaseTitle">ç«ç‘°é»‘æ–‘ç—… (Rose Black Spot)</div>
                <div class="toolbar-left">
                    <button class="btn btn-success" onclick="saveChanges()">ğŸ’¾ ä¿å­˜ä¿®æ”¹</button>
                    <button class="btn" onclick="createSnapshot()">ğŸ“¸ ä¿å­˜å¿«ç…§</button>
                    <button class="btn" onclick="showVersionHistory()">ğŸ“‹ ç‰ˆæœ¬å†å²</button>
                    <button class="btn" onclick="exportKnowledge()">ğŸ“¤ å¯¼å‡º</button>
                </div>
            </div>

            <div class="content-body">
                <!-- åŸºæœ¬ä¿¡æ¯ -->
                <div class="dimension-card">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-title">
                            ğŸ“ åŸºæœ¬ä¿¡æ¯
                            <span class="ontology-badge">ç–¾ç—…æœ¬ä½“</span>
                        </div>
                        <div class="card-meta">
                            <span class="collapse-icon">â–¼</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="field-group">
                            <div class="field-label">ç–¾ç—…ID</div>
                            <input type="text" class="field-value" value="rose_black_spot" disabled>
                        </div>
                        <div class="field-group">
                            <div class="field-label">ä¸­æ–‡åç§°</div>
                            <input type="text" class="field-value" value="ç«ç‘°é»‘æ–‘ç—…">
                        </div>
                        <div class="field-group">
                            <div class="field-label">è‹±æ–‡åç§°</div>
                            <input type="text" class="field-value" value="Rose Black Spot">
                        </div>
                        <div class="field-group">
                            <div class="field-label">ç—…åŸä½“</div>
                            <input type="text" class="field-value" value="Diplocarpon rosae (çœŸèŒ)">
                        </div>
                    </div>
                </div>

                <!-- ç»´åº¦1: ç—‡çŠ¶ç±»å‹ -->
                <div class="dimension-card">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-title">
                            ğŸ¯ ç»´åº¦1: ç—‡çŠ¶ç±»å‹ (symptom_type)
                            <span class="ontology-badge">ç‰¹å¾æœ¬ä½“</span>
                        </div>
                        <div class="card-meta">
                            <span class="weight-badge">æƒé‡: 50%</span>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="field-group">
                            <div class="field-label">æ ‡å‡†å€¼</div>
                            <input type="text" class="field-value" value="necrosis_spot">
                        </div>
                        <div class="field-group">
                            <div class="field-label">æœ¯è¯­</div>
                            <input type="text" class="field-value" value="åæ­»æ–‘ç‚¹">
                        </div>

                        <div class="vlm-descriptions">
                            <div class="vlm-title">ğŸ¤– VLM å¯ç†è§£çš„æè¿°</div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ’Š å½±åƒå­¦æè¿°ï¼ˆåŒ»å­¦/ç—…ç†å­¦æœ¯è¯­ï¼‰</div>
                                <textarea class="vlm-textarea">å¶ç‰‡ç»„ç»‡åæ­»å½¢æˆçš„é»‘è‰²æˆ–æ·±è¤è‰²æ–‘ç‚¹ï¼Œè¾¹ç•Œæ¸…æ™°ï¼Œä¸­å¿ƒåŒºåŸŸç»†èƒå®Œå…¨æ­»äº¡ï¼Œå‘¨å›´æœ‰é»„è‰²æ™•åœˆã€‚æ–‘ç‚¹è¡¨é¢å¯èƒ½æœ‰ç»†å¾®è£‚çº¹æˆ–å‡¹é™·ã€‚</textarea>
                            </div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ’¬ æ—¥å¸¸ç”¨è¯­ï¼ˆè§†è§‰æ¯”å–»å’Œç±»æ¯”ï¼‰</div>
                                <textarea class="vlm-textarea">â€¢ åƒè¢«é¦™çƒŸçƒ«è¿‡ç•™ä¸‹çš„ç„¦ç—•ï¼Œä¸­é—´é»‘è‰²ï¼Œå‘¨å›´å‘é»„
â€¢ ç±»ä¼¼çº¸å¼ è¢«ç«æ˜Ÿçƒ§å‡ºçš„å°æ´è¾¹ç¼˜
â€¢ å¥½æ¯”å¢¨æ±æ»´åœ¨ç»¿è‰²å¸ƒæ–™ä¸Šï¼Œå½¢æˆæ·±è‰²æ–‘å—
â€¢ ä»¿ä½›å¶å­è¢«è…èš€å‰‚ç‚¹åˆ°ï¼Œå‡ºç°é»‘è‰²å‘æ´</textarea>
                            </div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ“ ç©ºé—´å®šä½æ–¹æ³•</div>
                                <textarea class="vlm-textarea">ç—…æ–‘é€šå¸¸æ•£å¸ƒåœ¨å¶ç‰‡ä¸»ä½“åŒºåŸŸï¼Œä¼˜å…ˆè§‚å¯Ÿå¶ç‰‡æ­£é¢ï¼Œç—…æ–‘ç›´å¾„é€šå¸¸2-12mmï¼Œå¤šä¸ªæ–‘ç‚¹å¯èƒ½åˆ†å¸ƒåœ¨åŒä¸€å¶ç‰‡çš„ä¸åŒä½ç½®ã€‚</textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç»´åº¦2: ä¸­å¿ƒé¢œè‰² -->
                <div class="dimension-card">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-title">
                            ğŸ¨ ç»´åº¦2: ä¸­å¿ƒé¢œè‰² (color_center)
                            <span class="ontology-badge">ç‰¹å¾æœ¬ä½“</span>
                        </div>
                        <div class="card-meta">
                            <span class="weight-badge">æƒé‡: 10%</span>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="field-group">
                            <div class="field-label">æ ‡å‡†å€¼</div>
                            <input type="text" class="field-value" value="black">
                        </div>
                        <div class="field-group">
                            <div class="field-label">æœ¯è¯­</div>
                            <input type="text" class="field-value" value="é»‘è‰²">
                        </div>

                        <div class="vlm-descriptions">
                            <div class="vlm-title">ğŸ¤– VLM å¯ç†è§£çš„æè¿°</div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ’Š å½±åƒå­¦æè¿°</div>
                                <textarea class="vlm-textarea">ç—…æ–‘ä¸­å¿ƒå‘ˆæ·±é»‘è‰²è‡³é»‘è¤è‰²ï¼Œé¢œè‰²å‡åŒ€ï¼Œè¡¨é¢å¯èƒ½ç•¥æ˜¾å…‰æ³½æˆ–å¹²ç‡¥ï¼Œä¸å‘¨å›´å¥åº·ç»„ç»‡å½¢æˆé²œæ˜å¯¹æ¯”ã€‚</textarea>
                            </div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ’¬ æ—¥å¸¸ç”¨è¯­</div>
                                <textarea class="vlm-textarea">â€¢ åƒé»‘è‰²å¢¨æ°´æ¸çš„ä¸­å¿ƒéƒ¨åˆ†
â€¢ ç±»ä¼¼çƒ§ç„¦çš„çº¸å¼ ä¸­å¿ƒï¼Œå‘ˆç‚­é»‘è‰²
â€¢ å¥½æ¯”æ·±è‰²å°ç« çš„å¢¨è¿¹ï¼Œæµ“é»‘è€Œæ¸…æ™°</textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç»´åº¦3: è¾¹ç¼˜é¢œè‰² -->
                <div class="dimension-card">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-title">
                            ğŸ”µ ç»´åº¦3: è¾¹ç¼˜é¢œè‰² (color_border)
                            <span class="ontology-badge">ç‰¹å¾æœ¬ä½“</span>
                        </div>
                        <div class="card-meta">
                            <span class="weight-badge">æƒé‡: 30%</span>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="field-group">
                            <div class="field-label">æ ‡å‡†å€¼</div>
                            <input type="text" class="field-value" value="halo_yellow">
                        </div>
                        <div class="field-group">
                            <div class="field-label">æœ¯è¯­</div>
                            <input type="text" class="field-value" value="é»„è‰²æ™•åœˆ">
                        </div>

                        <div class="vlm-descriptions">
                            <div class="vlm-title">ğŸ¤– VLM å¯ç†è§£çš„æè¿°</div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ’Š å½±åƒå­¦æè¿°</div>
                                <textarea class="vlm-textarea">ç—…æ–‘å‘¨å›´æœ‰æ˜æ˜¾çš„é»„è‰²æ™•åœˆï¼Œå®½åº¦çº¦1-3mmï¼Œé¢œè‰²ä»ä¸­å¿ƒå‘å¤–é€æ¸è¿‡æ¸¡ï¼Œä»é»‘è‰²åˆ°é»„è‰²å†åˆ°æ­£å¸¸ç»¿è‰²ã€‚æ™•åœˆè¾¹ç•Œç›¸å¯¹æ¨¡ç³Šã€‚</textarea>
                            </div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ’¬ æ—¥å¸¸ç”¨è¯­</div>
                                <textarea class="vlm-textarea">â€¢ åƒå¤ªé˜³çš„å…‰æ™•ï¼Œä¸­å¿ƒæš—ï¼Œå‘¨å›´æ³›é»„å…‰
â€¢ ç±»ä¼¼æ°´å½©ç”»ä¸­é¢œæ–™æ‰©æ•£çš„è¾¹ç¼˜æ•ˆæœ
â€¢ å¥½æ¯”æ²¹æ¸åœ¨çº¸ä¸Šæ‰©æ•£å½¢æˆçš„é»„è‰²åœˆ
â€¢ ä»¿ä½›é»‘è‰²æ–‘ç‚¹è¢«é‡‘é»„è‰²å…‰ç¯å›´ç»•</textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç»´åº¦4: å‘ç—…ä½ç½® -->
                <div class="dimension-card collapsed">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-title">
                            ğŸ“ ç»´åº¦4: å‘ç—…ä½ç½® (location)
                            <span class="ontology-badge">ç‰¹å¾æœ¬ä½“</span>
                        </div>
                        <div class="card-meta">
                            <span class="weight-badge">æƒé‡: 5%</span>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="field-group">
                            <div class="field-label">æ ‡å‡†å€¼</div>
                            <input type="text" class="field-value" value="lamina">
                        </div>
                        <div class="field-group">
                            <div class="field-label">æœ¯è¯­</div>
                            <input type="text" class="field-value" value="å¶ç‰‡ä¸»ä½“">
                        </div>

                        <div class="vlm-descriptions">
                            <div class="vlm-title">ğŸ¤– VLM å¯ç†è§£çš„æè¿°</div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ’Š å½±åƒå­¦æè¿°</div>
                                <textarea class="vlm-textarea">ç—…æ–‘ä¸»è¦å‡ºç°åœ¨å¶ç‰‡çš„å¶èº«åŒºåŸŸï¼ˆéå¶å°–ã€å¶ç¼˜æˆ–å¶æŸ„ï¼‰ï¼Œåˆ†å¸ƒåœ¨å¶è„‰ä¹‹é—´çš„ç»„ç»‡ä¸Šã€‚</textarea>
                            </div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ’¬ æ—¥å¸¸ç”¨è¯­</div>
                                <textarea class="vlm-textarea">â€¢ ç—…æ–‘é•¿åœ¨å¶å­çš„"è‚šå­"ä¸Šï¼Œä¸åœ¨è¾¹è¾¹è§’è§’
â€¢ å‡ºç°åœ¨å¶ç‰‡çš„ä¸»è¦éƒ¨åˆ†ï¼Œè¿œç¦»å¶å­è¾¹ç¼˜
â€¢ ä½äºå¶å­ä¸­é—´åŒºåŸŸï¼Œä¸åœ¨å¶å°–æˆ–å¶æ¢—</textarea>
                            </div>

                            <div class="vlm-section">
                                <div class="vlm-subtitle">ğŸ“ ç©ºé—´å®šä½æ–¹æ³•</div>
                                <textarea class="vlm-textarea">æ’é™¤å¶å°–ï¼ˆæœ€å‰ç«¯1/5åŒºåŸŸï¼‰ã€å¶ç¼˜ï¼ˆè¾¹ç¼˜2mmä»¥å†…ï¼‰ã€å¶æŸ„ï¼ˆè¿æ¥èŒçš„éƒ¨åˆ†ï¼‰åï¼Œå‰©ä½™çš„å¶ç‰‡ä¸­å¤®å’Œä¸¤ä¾§ä¸»è¦åŒºåŸŸã€‚</textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å…¶ä»–æ¬¡è¦ç»´åº¦ï¼ˆæŠ˜å çŠ¶æ€ï¼‰ -->
                <div class="dimension-card collapsed">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-title">
                            ğŸ“ ç»´åº¦5: æ–‘ç‚¹å¤§å° (size)
                            <span class="ontology-badge">ç‰¹å¾æœ¬ä½“</span>
                        </div>
                        <div class="card-meta">
                            <span class="weight-badge">æƒé‡: 2%</span>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="field-group">
                            <div class="field-label">æ ‡å‡†å€¼</div>
                            <input type="text" class="field-value" value="medium">
                        </div>
                        <div class="field-group">
                            <div class="field-label">æœ¯è¯­</div>
                            <input type="text" class="field-value" value="ä¸­ç­‰ (3-8mm)">
                        </div>
                    </div>
                </div>

                <div class="dimension-card collapsed">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-title">
                            ğŸ—ºï¸ ç»´åº¦6: åˆ†å¸ƒæ¨¡å¼ (distribution)
                            <span class="ontology-badge">ç‰¹å¾æœ¬ä½“</span>
                        </div>
                        <div class="card-meta">
                            <span class="weight-badge">æƒé‡: 2%</span>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="field-group">
                            <div class="field-label">æ ‡å‡†å€¼</div>
                            <input type="text" class="field-value" value="scattered">
                        </div>
                        <div class="field-group">
                            <div class="field-label">æœ¯è¯­</div>
                            <input type="text" class="field-value" value="æ•£ç‚¹åˆ†å¸ƒ">
                        </div>
                    </div>
                </div>

                <!-- æ²»ç–—çŸ¥è¯† -->
                <div class="treatment-section">
                    <div class="section-header" onclick="toggleTreatment(this)">
                        <div class="section-title">
                            ğŸ’Š æ²»ç–—çŸ¥è¯†ï¼ˆé¢„ç•™æ¥å£ï¼‰
                            <span class="ontology-badge">æ²»ç–—æœ¬ä½“</span>
                        </div>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="treatment-content">
                        <div class="field-group">
                            <div class="field-label">åŒ–å­¦é˜²æ²»</div>
                            <textarea class="vlm-textarea">â€¢ å‘ç—…åˆæœŸå–·æ´’75%ç™¾èŒæ¸…å¯æ¹¿æ€§ç²‰å‰‚600-800å€æ¶²
â€¢ æˆ–ä½¿ç”¨70%ä»£æ£®é”°é”Œå¯æ¹¿æ€§ç²‰å‰‚500å€æ¶²
â€¢ æ¯7-10å¤©å–·ä¸€æ¬¡ï¼Œè¿ç»­å–·2-3æ¬¡</textarea>
                        </div>
                        <div class="field-group">
                            <div class="field-label">å†œä¸šé˜²æ²»</div>
                            <textarea class="vlm-textarea">â€¢ åŠæ—¶æ¸…é™¤ç—…å¶å’Œè½å¶ï¼Œå‡å°‘ä¾µæŸ“æº
â€¢ åŠ å¼ºé€šé£é€å…‰ï¼Œé™ä½å¶é¢æ¹¿åº¦
â€¢ é¿å…åæ–½æ°®è‚¥ï¼Œå¢æ–½ç£·é’¾è‚¥æé«˜æŠ—æ€§</textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç‰ˆæœ¬å†å²æ¨¡æ€æ¡† -->
    <div class="modal" id="versionModal">
        <div class="modal-content">
            <div class="modal-header">ğŸ“‹ ç‰ˆæœ¬å†å²</div>
            <div class="modal-body">
                <ul class="version-list">
                    <li class="version-item" onclick="loadVersion('v1.3')">
                        <div class="version-name">v1.3 - å½“å‰ç‰ˆæœ¬</div>
                        <div class="version-meta">2025-11-14 10:30 | æ›´æ–°VLMæè¿°</div>
                    </li>
                    <li class="version-item" onclick="loadVersion('v1.2')">
                        <div class="version-name">v1.2 - å¿«ç…§_20251113</div>
                        <div class="version-meta">2025-11-13 15:20 | è°ƒæ•´æƒé‡é…ç½®</div>
                    </li>
                    <li class="version-item" onclick="loadVersion('v1.1')">
                        <div class="version-name">v1.1 - å¿«ç…§_20251110</div>
                        <div class="version-meta">2025-11-10 09:15 | åˆå§‹åŒ–çŸ¥è¯†åº“</div>
                    </li>
                    <li class="version-item" onclick="loadVersion('v1.0')">
                        <div class="version-name">v1.0 - åŸºç¡€ç‰ˆæœ¬</div>
                        <div class="version-meta">2025-11-01 14:00 | åˆ›å»ºç–¾ç—…æ¡ç›®</div>
                    </li>
                </ul>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeModal('versionModal')">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- ä¿å­˜æˆåŠŸæ¨¡æ€æ¡† -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="modal-header">âœ“ ä¿å­˜æˆåŠŸ</div>
            <div class="modal-body">
                <p>çŸ¥è¯†å·²æˆåŠŸä¿å­˜å¹¶éªŒè¯é€šè¿‡ï¼</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeModal('successModal')">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <script>
        function toggleTreeNode(element) {
            const icon = element.querySelector('.tree-icon');
            const children = element.nextElementSibling;

            if (icon && children) {
                icon.classList.toggle('expanded');
                children.classList.toggle('visible');
            }
        }

        function selectDisease(diseaseId) {
            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            const items = document.querySelectorAll('.tree-item');
            items.forEach(item => item.classList.remove('active'));
            event.currentTarget.classList.add('active');

            // æ¨¡æ‹ŸåŠ è½½ä¸åŒç–¾ç—…æ•°æ®
            const diseaseNames = {
                'rose_black_spot': 'ç«ç‘°é»‘æ–‘ç—… (Rose Black Spot)',
                'rose_powdery_mildew': 'ç«ç‘°ç™½ç²‰ç—… (Rose Powdery Mildew)',
                'rose_rust': 'ç«ç‘°é”ˆç—… (Rose Rust)',
                'cherry_powdery_mildew': 'æ¨±èŠ±ç™½ç²‰ç—… (Cherry Powdery Mildew)',
                'cherry_leaf_spot': 'æ¨±èŠ±å¶æ–‘ç—… (Cherry Leaf Spot)',
                'tulip_gray_mold': 'éƒé‡‘é¦™ç°éœ‰ç—… (Tulip Gray Mold)',
                'tulip_fire': 'éƒé‡‘é¦™ç«ç–«ç—… (Tulip Fire)'
            };

            document.getElementById('diseaseTitle').textContent = diseaseNames[diseaseId] || diseaseId;

            console.log('å·²é€‰æ‹©ç–¾ç—…:', diseaseId);
        }

        function toggleCard(element) {
            const card = element.closest('.dimension-card') || element.closest('.treatment-section');
            card.classList.toggle('collapsed');
        }

        function toggleTreatment(element) {
            const section = element.closest('.treatment-section');
            section.classList.toggle('collapsed');
        }

        function saveChanges() {
            // æ¨¡æ‹Ÿä¿å­˜è¿‡ç¨‹
            console.log('æ­£åœ¨ä¿å­˜çŸ¥è¯†ä¿®æ”¹...');

            // æ”¶é›†æ‰€æœ‰è¾“å…¥å€¼
            const inputs = document.querySelectorAll('.field-value, .vlm-textarea');
            const data = {};
            inputs.forEach(input => {
                if (!input.disabled) {
                    console.log('å­—æ®µå€¼:', input.value);
                }
            });

            // æ˜¾ç¤ºæˆåŠŸæç¤º
            setTimeout(() => {
                document.getElementById('successModal').classList.add('active');
            }, 300);
        }

        function createSnapshot() {
            const timestamp = new Date().toISOString().slice(0, 19).replace('T', '_');
            const snapshotName = `å¿«ç…§_${timestamp}.zip`;

            if (confirm(`ç¡®å®šè¦åˆ›å»ºå¿«ç…§å—ï¼Ÿ\n\nå¿«ç…§åç§°: ${snapshotName}\nåŒ…å«: å½“å‰æ‰€æœ‰ç–¾ç—…çŸ¥è¯†çš„å®Œæ•´æ•°æ®`)) {
                console.log('åˆ›å»ºå¿«ç…§:', snapshotName);
                alert(`å¿«ç…§åˆ›å»ºæˆåŠŸï¼\n\næ–‡ä»¶: ${snapshotName}\nä½ç½®: /snapshots/`);
            }
        }

        function showVersionHistory() {
            document.getElementById('versionModal').classList.add('active');
        }

        function loadVersion(version) {
            if (confirm(`ç¡®å®šè¦æ¢å¤åˆ°ç‰ˆæœ¬ ${version} å—ï¼Ÿ\n\nå½“å‰æœªä¿å­˜çš„ä¿®æ”¹å°†ä¸¢å¤±ã€‚`)) {
                console.log('æ¢å¤ç‰ˆæœ¬:', version);
                closeModal('versionModal');
                alert(`å·²æ¢å¤åˆ°ç‰ˆæœ¬ ${version}`);
            }
        }

        function exportKnowledge() {
            const options = [
                'JSONæ ¼å¼ (å®Œæ•´æ•°æ®)',
                'Excelæ ¼å¼ (è¡¨æ ¼è§†å›¾)',
                'Markdownæ ¼å¼ (æ–‡æ¡£)'
            ];

            const choice = prompt(`è¯·é€‰æ‹©å¯¼å‡ºæ ¼å¼ï¼š\n\n1. ${options[0]}\n2. ${options[1]}\n3. ${options[2]}\n\nè¯·è¾“å…¥æ•°å­— 1-3:`);

            if (choice) {
                const format = options[parseInt(choice) - 1] || options[0];
                console.log('å¯¼å‡ºæ ¼å¼:', format);
                alert(`æ­£åœ¨å¯¼å‡º: ${format}\n\næ–‡ä»¶å°†ä¿å­˜åˆ°ä¸‹è½½ç›®å½•ã€‚`);
            }
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        function goBack() {
            if (confirm('ç¡®å®šè¦è¿”å›é¦–é¡µå—ï¼Ÿæœªä¿å­˜çš„ä¿®æ”¹å°†ä¸¢å¤±ã€‚')) {
                alert('è¿”å›é¦–é¡µ');
            }
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        }
    </script>
</body>
</html>
